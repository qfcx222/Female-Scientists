import networkx as nx
import matplotlib.pyplot as plt

# 1. é…ç½®Windowsä¸­æ–‡å­—ä½“ï¼ˆè§£å†³ä¸­æ–‡æ˜¾ç¤ºå¼‚å¸¸ï¼‰
try:
    plt.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei', 'Arial']
    plt.rcParams['axes.unicode_minus'] = False
    print("âœ… ä¸­æ–‡å­—ä½“é…ç½®æˆåŠŸ")
except Exception as e:
    print(f"âš ï¸ ä¸­æ–‡å­—ä½“é…ç½®æç¤º: {e}ï¼Œå°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“")
    plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Arial']
    plt.rcParams['axes.unicode_minus'] = False

# 2. æ ¸å¿ƒå…³ç³»æ•°æ®ï¼ˆæŒ‰å…³ç³»ç±»å‹åˆ†ç±»ï¼Œç²¾ç®€æ ‡ç­¾ï¼‰
core_person = "ä¸½ä¸Â·è¿ˆç‰¹çº³"
family = [
    "è²åˆ©æ™®Â·è¿ˆç‰¹çº³(çˆ¶)", "èµ«å¾·ç»´å¸ŒÂ·æ–¯è€ƒå¤«æœ—(æ¯)",
    "å‰å¡æ‹‰(å§)", "å¥¥å¤æ–¯ç‰¹(å…„)", "è«é‡ŒèŒ¨(å¼Ÿ)",
    "å¡åŠ³æ‹‰(å¦¹)", "å¼—ç‘è¾¾(å¦¹)", "ç“¦è€³ç‰¹(å¼Ÿ)",
    "å¥¥æ‰˜Â·ç½—ä¼¯ç‰¹Â·å¼—é‡Œä»€(å¤–ç”¥)"
]
teachers = [
    "é˜¿å›¾å°”Â·æŸ¥å°”ç“¦è¥¿(ç‰©ç†/æ•°å­¦å¯¼)", "å¼—æœ—èŒ¨Â·è‰¾å…‹æ–¯è¯º(åšå£«å¯¼)",
    "è·¯å¾·ç»´å¸ŒÂ·ç»è€³å…¹æ›¼(ç†è®ºç‰©ç†å¯¼)", "æ³¢ç‰¹(å¾·å¯¼)",
    "å…‹å…°èŒ¨(å¾·å¯¼)", "çº¦é‡Œå¥¥-å±…é‡Œ(æ³•å¯¼)", "é©¬ç§‘æ–¯Â·æ™®æœ—å…‹(æŸæ—å¯¼)"
]
long_term_collaborators = [
    "å¥¥æ‰˜Â·å“ˆæ©(ç»ˆèº«åˆä½œè€…)", "å¼—é‡ŒèŒ¨Â·æ–¯ç‰¹å–‡æ–¯æ›¼(é“€ç ”ç©¶)",
    "å¥¥æ‰˜Â·å°Â·è´è€¶å°”(Î²è°±ç ”ç©¶)"
]
colleagues = [
    "å°¼è€³æ–¯Â·ç»å°”(ç§‘ç ”åŒé“)", "é©¬ç§‘æ–¯Â·å°Â·åŠ³å„(æŒšå‹)",
    "æ°å§†æ–¯Â·å¼—æœ—å…‹(åŒäº‹)", "å¤æ–¯å¡”å¤«Â·èµ«å…¹(åŒäº‹)",
    "æ–¯å¿’è—©Â·è¿ˆè€¶å°”(ç»´ä¹Ÿçº³åŒé“)", "çˆ±ä¼¦Â·å±…é‡Œ(ç§‘ç ”äº¤æµ)",
    "è…“ç‰¹çƒˆÂ·çº¦é‡Œå¥¥(ç§‘ç ”äº¤æµ)", "æ©é‡Œç§‘Â·è´¹å¯†(ç§‘ç ”äº¤æµ)"
]
students = [
    "å°¼å¤æ‹‰æ–¯Â·ç‘è€³(åŠ©æ‰‹)", "åº“å°”ç‰¹Â·è²åˆ©æ™®(åŠ©æ‰‹)",
    "K.é“çº³ç‰¹(åŠ©æ‰‹)", "å¨å»‰Â·å¥¥å°”ç‰¹æ›¼(åŠ©æ‰‹)"
]

# 3. å…³ç³»è¾¹ï¼ˆç²¾ç®€æè¿°ï¼Œæ ‡æ³¨æ ¸å¿ƒå…³è”ï¼‰
edges = [
    # æ ¸å¿ƒ â†” å®¶äºº
    (core_person, "è²åˆ©æ™®Â·è¿ˆç‰¹çº³(çˆ¶)", "çˆ¶å¥³"),
    (core_person, "èµ«å¾·ç»´å¸ŒÂ·æ–¯è€ƒå¤«æœ—(æ¯)", "æ¯å¥³"),
    (core_person, "å‰å¡æ‹‰(å§)", "å§å¦¹"),
    (core_person, "å¥¥å¤æ–¯ç‰¹(å…„)", "å…„å¦¹"),
    (core_person, "ç“¦è€³ç‰¹(å¼Ÿ)", "å§å¼Ÿ"),
    (core_person, "å¥¥æ‰˜Â·ç½—ä¼¯ç‰¹Â·å¼—é‡Œä»€(å¤–ç”¥)", "å§¨ç”¥+ç§‘ç ”åˆä½œ"),

    # æ ¸å¿ƒ â†” å¯¼å¸ˆ
    (core_person, "é˜¿å›¾å°”Â·æŸ¥å°”ç“¦è¥¿(ç‰©ç†/æ•°å­¦å¯¼)", "å¸ˆç”Ÿ(é¢„ç§‘è¾…å¯¼)"),
    (core_person, "è·¯å¾·ç»´å¸ŒÂ·ç»è€³å…¹æ›¼(ç†è®ºç‰©ç†å¯¼)", "å¸ˆç”Ÿ(é‡å­ç‰©ç†)"),
    (core_person, "å¼—æœ—èŒ¨Â·è‰¾å…‹æ–¯è¯º(åšå£«å¯¼)", "å¸ˆç”Ÿ(åšå£«ç ”ç©¶)"),
    (core_person, "çº¦é‡Œå¥¥-å±…é‡Œ(æ³•å¯¼)", "å¸ˆç”Ÿ(å±…é‡Œå®éªŒå®¤)"),
    (core_person, "é©¬ç§‘æ–¯Â·æ™®æœ—å…‹(æŸæ—å¯¼)", "å¸ˆç”Ÿ+æŒšå‹"),

    # æ ¸å¿ƒ â†” é•¿æœŸåˆä½œè€…
    (core_person, "å¥¥æ‰˜Â·å“ˆæ©(ç»ˆèº«åˆä½œè€…)", "åŒäº‹+ç§‘ç ”(è£‚å˜/é•¤)"),
    (core_person, "å¼—é‡ŒèŒ¨Â·æ–¯ç‰¹å–‡æ–¯æ›¼(é“€ç ”ç©¶)", "åŒäº‹(é“€è£‚å˜å®éªŒ)"),
    (core_person, "å¥¥æ‰˜Â·å°Â·è´è€¶å°”(Î²è°±ç ”ç©¶)", "åŒäº‹(Î²èƒ½è°±å®éªŒ)"),

    # æ ¸å¿ƒ â†” ç§‘ç ”åŒé“
    (core_person, "å°¼è€³æ–¯Â·ç»å°”(ç§‘ç ”åŒé“)", "å­¦æœ¯äº¤æµ(æ ¸ç‰©ç†)"),
    (core_person, "é©¬ç§‘æ–¯Â·å°Â·åŠ³å„(æŒšå‹)", "åŒäº‹+åçº³ç²¹åŒé“"),
    (core_person, "æ–¯å¿’è—©Â·è¿ˆè€¶å°”(ç»´ä¹Ÿçº³åŒé“)", "é•¿æœŸé€šä¿¡+å­¦æœ¯æ”¯æŒ"),
    (core_person, "çˆ±ä¼¦Â·å±…é‡Œ(ç§‘ç ”äº¤æµ)", "é“€ç ”ç©¶ç›¸äº’éªŒè¯"),

    # æ ¸å¿ƒ â†” å­¦ç”Ÿ/åŠ©æ‰‹
    (core_person, "åº“å°”ç‰¹Â·è²åˆ©æ™®(åŠ©æ‰‹)", "å¸ˆå¾’(æ ¸ç‰©ç†å®éªŒ)"),
    (core_person, "å¨å»‰Â·å¥¥å°”ç‰¹æ›¼(åŠ©æ‰‹)", "å¸ˆå¾’(é‡çƒ­å­¦å®éªŒ)"),

    # è·¨å…³ç³»
    ("å¥¥æ‰˜Â·å“ˆæ©(ç»ˆèº«åˆä½œè€…)", "å¼—é‡ŒèŒ¨Â·æ–¯ç‰¹å–‡æ–¯æ›¼(é“€ç ”ç©¶)", "åŒäº‹(è£‚å˜å®éªŒ)"),
    ("å°¼è€³æ–¯Â·ç»å°”(ç§‘ç ”åŒé“)", "é©¬ç§‘æ–¯Â·æ™®æœ—å…‹(æŸæ—å¯¼)", "å­¦æœ¯æŒšå‹"),
    ("å¥¥æ‰˜Â·ç½—ä¼¯ç‰¹Â·å¼—é‡Œä»€(å¤–ç”¥)", "å°¼è€³æ–¯Â·ç»å°”(ç§‘ç ”åŒé“)", "å¸ˆç”Ÿ(å“¥æœ¬å“ˆæ ¹)")
]

# 4. åˆ›å»ºå›¾ç»“æ„
G = nx.Graph()
all_nodes = [core_person] + family + teachers + long_term_collaborators + colleagues + students
G.add_nodes_from(all_nodes)
for source, target, relation in edges:
    G.add_edge(source, target, relation=relation)

# 5. èŠ‚ç‚¹ç€è‰²ï¼ˆæŒ‰å…³ç³»ç±»å‹åŒºåˆ†ï¼Œé¢œè‰²æ¸…æ™°ä¸æ··æ·†ï¼‰
node_colors = []
for node in G.nodes():
    if node == core_person:
        node_colors.append('#FF5733')  # æ ¸å¿ƒï¼šæ©™çº¢
    elif node in family:
        node_colors.append('#3498DB')  # å®¶äººï¼šè“
    elif node in teachers:
        node_colors.append('#2ECC71')  # å¯¼å¸ˆï¼šç»¿
    elif node in long_term_collaborators:
        node_colors.append('#9B59B6')  # é•¿æœŸåˆä½œè€…ï¼šç´«
    elif node in colleagues:
        node_colors.append('#F39C12')  # ç§‘ç ”åŒé“ï¼šé»„
    elif node in students:
        node_colors.append('#1ABC9C')  # å­¦ç”Ÿ/åŠ©æ‰‹ï¼šé’

# 6. ç»˜åˆ¶å›¾è°±ï¼ˆå…¼å®¹ä½ç‰ˆæœ¬ï¼Œä¸­æ–‡æ­£å¸¸æ˜¾ç¤ºï¼‰
plt.figure(figsize=(16, 12))

# å¼¹ç°§å¸ƒå±€ï¼šå¢å¤§é—´è·é¿å…ä¸­æ–‡æ ‡ç­¾é‡å 
pos = nx.spring_layout(
    G,
    k=6.0,  # èŠ‚ç‚¹é—´è·ï¼ˆé€‚é…é•¿ä¸­æ–‡æ ‡ç­¾ï¼‰
    iterations=300,  # ä¼˜åŒ–å¸ƒå±€è¿­ä»£æ¬¡æ•°
    seed=42  # å›ºå®šå¸ƒå±€ï¼Œæ¯æ¬¡è¿è¡Œä¸€è‡´
)

# ç»˜åˆ¶èŠ‚ç‚¹ï¼ˆå°ºå¯¸é€‚é…ä¸­æ–‡æ ‡ç­¾ï¼‰
nx.draw_networkx_nodes(
    G, pos,
    node_size=8000,  # è¶³å¤Ÿå®¹çº³é•¿ä¸­æ–‡æ ‡ç­¾
    node_color=node_colors,
    alpha=0.9,
    edgecolors='black',
    linewidths=2
)

# ç»˜åˆ¶è¾¹ï¼ˆç°è‰²ä½è°ƒï¼Œä¸æŠ¢ç„¦ç‚¹ï¼‰
nx.draw_networkx_edges(G, pos, width=1.5, alpha=0.8, edge_color='#666666')

# ç»˜åˆ¶è¾¹æ ‡ç­¾ï¼ˆæä½ç‰ˆæœ¬nxæ”¯æŒfont_sizeï¼‰
edge_labels = nx.get_edge_attributes(G, 'relation')
nx.draw_networkx_edge_labels(
    G, pos,
    edge_labels=edge_labels,
    font_size=9,  # é€‚é…ä½ç‰ˆæœ¬networkx
    label_pos=0.4
)

# ç»˜åˆ¶èŠ‚ç‚¹æ ‡ç­¾ï¼ˆæä½ç‰ˆæœ¬nxæ”¯æŒfont_sizeï¼‰
nx.draw_networkx_labels(G, pos, font_size=11)

# ç»˜åˆ¶æ ‡é¢˜ï¼ˆmatplotlibæ”¯æŒfontsizeï¼Œæ— ä¸‹åˆ’çº¿ï¼‰
plt.title('ä¸½ä¸Â·è¿ˆç‰¹çº³æ ¸å¿ƒå…³ç³»ç½‘ç»œå›¾è°±', fontsize=18, pad=30)

# éšè—åæ ‡è½´ï¼Œä¿å­˜é«˜æ¸…å›¾è°±
plt.axis('off')
plt.tight_layout()
plt.savefig(
    'ä¸½ä¸Â·è¿ˆç‰¹çº³å…³ç³»å›¾è°±_ç»ˆæå…¼å®¹ç‰ˆ.png',
    dpi=300,
    bbox_inches='tight'  # ç¡®ä¿ä¸­æ–‡æ ‡ç­¾ä¸è¢«æˆªæ–­
)
plt.close()

print("ğŸ‰ å›¾è°±ç”ŸæˆæˆåŠŸï¼æ–‡ä»¶ï¼šä¸½ä¸Â·è¿ˆç‰¹çº³å…³ç³»å›¾è°±_ç»ˆæå…¼å®¹ç‰ˆ.png")
print(f"ğŸ“Š åŒ…å« {len(all_nodes)} ä½å…³é”®äººç‰©ï¼Œ{len(edges)} æ¡æ ¸å¿ƒå…³ç³»")
print("âœ… ä¸­æ–‡æ˜¾ç¤ºæ­£å¸¸ | âœ… æ— å‚æ•°é”™è¯¯ | âœ… å…¼å®¹ nx 1.x+ & matplotlib 2.x+")